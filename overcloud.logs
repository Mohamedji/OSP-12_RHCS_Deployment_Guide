The disable_upgrade_deployment flag is not set in the roles file. This flag is expected when you have a nova-compute or swift-storage role. Please check the contents of the roles file: [{'ServicesDefault': ['OS::TripleO::Services::CACerts', 'OS::TripleO::Services::CephMon', 'OS::TripleO::Services::CephExternal', 'OS::TripleO::Services::CephRbdMirror', 'OS::TripleO::Services::CinderApi', 'OS::TripleO::Services::CinderBackup', 'OS::TripleO::Services::CinderScheduler', 'OS::TripleO::Services::CinderVolume', 'OS::TripleO::Services::Congress', 'OS::TripleO::Services::Kernel', 'OS::TripleO::Services::Keystone', 'OS::TripleO::Services::GlanceApi', 'OS::TripleO::Services::HeatApi', 'OS::TripleO::Services::HeatApiCfn', 'OS::TripleO::Services::HeatApiCloudwatch', 'OS::TripleO::Services::HeatEngine', 'OS::TripleO::Services::MySQL', 'OS::TripleO::Services::MySQLClient', 'OS::TripleO::Services::NeutronDhcpAgent', 'OS::TripleO::Services::NeutronL3Agent', 'OS::TripleO::Services::NeutronMetadataAgent', 'OS::TripleO::Services::NeutronApi', 'OS::TripleO::Services::NeutronCorePlugin', 'OS::TripleO::Services::NeutronOvsAgent', 'OS::TripleO::Services::RabbitMQ', 'OS::TripleO::Services::HAproxy', 'OS::TripleO::Services::Keepalived', 'OS::TripleO::Services::Memcached', 'OS::TripleO::Services::Pacemaker', 'OS::TripleO::Services::Redis', 'OS::TripleO::Services::NovaConductor', 'OS::TripleO::Services::MongoDb', 'OS::TripleO::Services::NovaApi', 'OS::TripleO::Services::NovaPlacement', 'OS::TripleO::Services::NovaMetadata', 'OS::TripleO::Services::NovaScheduler', 'OS::TripleO::Services::NovaConsoleauth', 'OS::TripleO::Services::NovaVncProxy', 'OS::TripleO::Services::Ec2Api', 'OS::TripleO::Services::Ntp', 'OS::TripleO::Services::SwiftProxy', 'OS::TripleO::Services::SwiftStorage', 'OS::TripleO::Services::SwiftRingBuilder', 'OS::TripleO::Services::Snmp', 'OS::TripleO::Services::Sshd', 'OS::TripleO::Services::Timezone', 'OS::TripleO::Services::CeilometerApi', 'OS::TripleO::Services::CeilometerCollector', 'OS::TripleO::Services::CeilometerExpirer', 'OS::TripleO::Services::CeilometerAgentCentral', 'OS::TripleO::Services::CeilometerAgentNotification', 'OS::TripleO::Services::Horizon', 'OS::TripleO::Services::GnocchiApi', 'OS::TripleO::Services::GnocchiMetricd', 'OS::TripleO::Services::GnocchiStatsd', 'OS::TripleO::Services::AodhApi', 'OS::TripleO::Services::AodhEvaluator', 'OS::TripleO::Services::AodhNotifier', 'OS::TripleO::Services::AodhListener', 'OS::TripleO::Services::SaharaApi', 'OS::TripleO::Services::SaharaEngine', 'OS::TripleO::Services::IronicApi', 'OS::TripleO::Services::IronicConductor', 'OS::TripleO::Services::NovaIronic', 'OS::TripleO::Services::TripleoPackages', 'OS::TripleO::Services::TripleoFirewall', 'OS::TripleO::Services::OpenDaylightApi', 'OS::TripleO::Services::OpenDaylightOvs', 'OS::TripleO::Services::SensuClient', 'OS::TripleO::Services::FluentdClient', 'OS::TripleO::Services::Collectd', 'OS::TripleO::Services::BarbicanApi', 'OS::TripleO::Services::PankoApi', 'OS::TripleO::Services::Tacker', 'OS::TripleO::Services::Zaqar', 'OS::TripleO::Services::OVNDBs', 'OS::TripleO::Services::Etcd', 'OS::TripleO::Services::AuditD', 'OS::TripleO::Services::OctaviaApi', 'OS::TripleO::Services::OctaviaHealthManager', 'OS::TripleO::Services::OctaviaHousekeeping', 'OS::TripleO::Services::OctaviaWorker'], 'CountDefault': 1, 'HostnameFormatDefault': 'controller-%index%', 'name': 'Controller'}, {'ServicesDefault': ['OS::TripleO::Services::CACerts', 'OS::TripleO::Services::CephClient', 'OS::TripleO::Services::CephExternal', 'OS::TripleO::Services::Timezone', 'OS::TripleO::Services::Ntp', 'OS::TripleO::Services::Snmp', 'OS::TripleO::Services::Sshd', 'OS::TripleO::Services::NovaCompute', 'OS::TripleO::Services::NovaLibvirt', 'OS::TripleO::Services::Kernel', 'OS::TripleO::Services::ComputeNeutronCorePlugin', 'OS::TripleO::Services::ComputeNeutronOvsAgent', 'OS::TripleO::Services::ComputeCeilometerAgent', 'OS::TripleO::Services::ComputeNeutronL3Agent', 'OS::TripleO::Services::ComputeNeutronMetadataAgent', 'OS::TripleO::Services::TripleoPackages', 'OS::TripleO::Services::TripleoFirewall', 'OS::TripleO::Services::NeutronSriovAgent', 'OS::TripleO::Services::OpenDaylightOvs', 'OS::TripleO::Services::SensuClient', 'OS::TripleO::Services::FluentdClient', 'OS::TripleO::Services::AuditD', 'OS::TripleO::Services::Collectd'], 'CountDefault': 1, 'HostnameFormatDefault': '%stackname%-compute-r630-%index%', 'name': 'R630Compute'}, {'ServicesDefault': ['OS::TripleO::Services::CACerts', 'OS::TripleO::Services::CephClient', 'OS::TripleO::Services::CephExternal', 'OS::TripleO::Services::Timezone', 'OS::TripleO::Services::Ntp', 'OS::TripleO::Services::Snmp', 'OS::TripleO::Services::Sshd', 'OS::TripleO::Services::NovaCompute', 'OS::TripleO::Services::NovaLibvirt', 'OS::TripleO::Services::Kernel', 'OS::TripleO::Services::ComputeNeutronCorePlugin', 'OS::TripleO::Services::ComputeNeutronOvsAgent', 'OS::TripleO::Services::ComputeCeilometerAgent', 'OS::TripleO::Services::ComputeNeutronL3Agent', 'OS::TripleO::Services::ComputeNeutronMetadataAgent', 'OS::TripleO::Services::TripleoPackages', 'OS::TripleO::Services::TripleoFirewall', 'OS::TripleO::Services::NeutronSriovAgent', 'OS::TripleO::Services::OpenDaylightOvs', 'OS::TripleO::Services::SensuClient', 'OS::TripleO::Services::FluentdClient', 'OS::TripleO::Services::AuditD', 'OS::TripleO::Services::Collectd'], 'CountDefault': 1, 'HostnameFormatDefault': '%stackname%-compute-r220-%index%', 'name': 'R220Compute'}, {'ServicesDefault': ['OS::TripleO::Services::CACerts', 'OS::TripleO::Services::CephOSD', 'OS::TripleO::Services::Kernel', 'OS::TripleO::Services::Ntp', 'OS::TripleO::Services::Snmp', 'OS::TripleO::Services::Sshd', 'OS::TripleO::Services::Timezone', 'OS::TripleO::Services::TripleoPackages', 'OS::TripleO::Services::TripleoFirewall', 'OS::TripleO::Services::SensuClient', 'OS::TripleO::Services::FluentdClient', 'OS::TripleO::Services::AuditD', 'OS::TripleO::Services::Collectd'], 'CountDefault': 1, 'HostnameFormatDefault': 'cephstorage-%index%', 'name': 'CephStorage'}]
Waiting for messages on queue '67aa9f3f-f370-4fd0-a24d-aa34455c9971' with no timeout.
{u'execution': {u'created_at': u'2018-03-08 11:58:50',
                u'id': u'016f2ca5-97d8-4c58-a808-f609bef976b6',
                u'input': {u'container': u'overcloud',
                           u'queue_name': u'b8b9ecd3-dbdc-4630-b2c5-3033eb0b6f66',
                           u'run_validations': False,
                           u'skip_deploy_identifier': False,
                           u'timeout': 240},
                u'name': u'tripleo.deployment.v1.deploy_plan',
                u'params': {u'namespace': u''},
                u'spec': {u'description': u'Deploy the overcloud for a plan.\n',
                          u'input': [u'container',
                                     {u'run_validations': False},
                                     {u'timeout': 240},
                                     {u'skip_deploy_identifier': False},
                                     {u'queue_name': u'tripleo'}],
                          u'name': u'deploy_plan',
                          u'tags': [u'tripleo-common-managed'],
                          u'tasks': {u'add_validation_ssh_key': {u'input': {u'container': u'<% $.container %>',
                                                                            u'queue_name': u'<% $.queue_name %>'},
                                                                 u'name': u'add_validation_ssh_key',
                                                                 u'on-complete': [{u'run_validations': u'<% $.run_validations %>'},
                                                                                  {u'create_swift_rings_backup_plan': u'<% not $.run_validations %>'}],
                                                                 u'type': u'direct',
                                                                 u'version': u'2.0',
                                                                 u'workflow': u'tripleo.validations.v1.add_validation_ssh_key_parameter'},
                                     u'create_swift_rings_backup_plan': {u'input': {u'container': u'<% $.container %>',
                                                                                    u'queue_name': u'<% $.queue_name %>',
                                                                                    u'use_default_templates': True},
                                                                         u'name': u'create_swift_rings_backup_plan',
                                                                         u'on-error': u'create_swift_rings_backup_plan_set_status_failed',
                                                                         u'on-success': u'get_heat_stack',
                                                                         u'type': u'direct',
                                                                         u'version': u'2.0',
                                                                         u'workflow': u'tripleo.swift_rings_backup.v1.create_swift_rings_backup_container_plan'},
                                     u'create_swift_rings_backup_plan_set_status_failed': {u'name': u'create_swift_rings_backup_plan_set_status_failed',
                                                                                           u'on-success': u'send_message',
                                                                                           u'publish': {u'message': u'<% task(create_swift_rings_backup_plan).result %>',
                                                                                                        u'status': u'FAILED'},
                                                                                           u'type': u'direct',
                                                                                           u'version': u'2.0'},
                                     u'deploy': {u'action': u'tripleo.deployment.deploy',
                                                 u'input': {u'container': u'<% $.container %>',
                                                            u'skip_deploy_identifier': u'<% $.skip_deploy_identifier %>',
                                                            u'timeout': u'<% $.timeout %>'},
                                                 u'name': u'deploy',
                                                 u'on-error': u'set_deployment_failed',
                                                 u'on-success': u'send_message',
                                                 u'type': u'direct',
                                                 u'version': u'2.0'},
                                     u'get_heat_stack': {u'action': u'heat.stacks_get stack_id=<% $.container %>',
                                                         u'name': u'get_heat_stack',
                                                         u'on-error': u'deploy',
                                                         u'on-success': [{u'set_stack_in_progress': u'<% "_IN_PROGRESS" in task(get_heat_stack).result.stack_status %>'},
                                                                         {u'deploy': u'<% not "_IN_PROGRESS" in task(get_heat_stack).result.stack_status %>'}],
                                                         u'type': u'direct',
                                                         u'version': u'2.0'},
                                     u'run_validations': {u'input': {u'group_names': [u'pre-deployment'],
                                                                     u'plan': u'<% $.container %>',
                                                                     u'queue_name': u'<% $.queue_name %>'},
                                                          u'name': u'run_validations',
                                                          u'on-error': u'set_validations_failed',
                                                          u'on-success': u'create_swift_rings_backup_plan',
                                                          u'type': u'direct',
                                                          u'version': u'2.0',
                                                          u'workflow': u'tripleo.validations.v1.run_groups'},
                                     u'send_message': {u'action': u'zaqar.queue_post',
                                                       u'input': {u'messages': {u'body': {u'payload': {u'execution': u'<% execution() %>',
                                                                                                       u'message': u"<% $.get('message', '') %>",
                                                                                                       u'status': u"<% $.get('status', 'SUCCESS') %>"},
                                                                                          u'type': u'tripleo.deployment.v1.deploy_plan'}},
                                                                  u'queue_name': u'<% $.queue_name %>'},
                                                       u'name': u'send_message',
                                                       u'on-success': [{u'fail': u'<% $.get(\'status\') = "FAILED" %>'}],
                                                       u'retry': u'count=5 delay=1',
                                                       u'type': u'direct',
                                                       u'version': u'2.0'},
                                     u'set_deployment_failed': {u'name': u'set_deployment_failed',
                                                                u'on-success': u'send_message',
                                                                u'publish': {u'message': u'<% task(deploy).result %>',
                                                                             u'status': u'FAILED'},
                                                                u'type': u'direct',
                                                                u'version': u'2.0'},
                                     u'set_stack_in_progress': {u'name': u'set_stack_in_progress',
                                                                u'on-success': u'send_message',
                                                                u'publish': {u'message': u'The Heat stack is busy.',
                                                                             u'status': u'FAILED'},
                                                                u'type': u'direct',
                                                                u'version': u'2.0'},
                                     u'set_validations_failed': {u'name': u'set_validations_failed',
                                                                 u'on-success': u'send_message',
                                                                 u'publish': {u'message': u'<% task(run_validations).result %>',
                                                                              u'status': u'FAILED'},
                                                                 u'type': u'direct',
                                                                 u'version': u'2.0'}},
                          u'version': u'2.0'}},
 u'message': u"Failed to run action [action_ex_id=4619eb40-ce1b-4049-9ace-f52d3da66bd3, action_cls='<class 'mistral.actions.action_factory.DeployStackAction'>', attributes='{}', params='{u'skip_deploy_identifier': False, u'container': u'overcloud', u'timeout': 240}']\n ERROR: Property error: : resources.R220Compute<nested_stack>.resources.0<https://192.168.24.2:13808/v1/AUTH_9885202debb14fdbac60a36ebe9204ea/overcloud/puppet/r220compute-role.yaml>.resources.NetworkConfig.properties: : Unknown Property StorageMgmtIpSubnet",
 u'status': u'FAILED'}
Started Mistral Workflow tripleo.validations.v1.check_pre_deployment_validations. Execution ID: 6bcfb24c-e510-444f-aa1d-decbbd02a524
Creating Swift container to store the plan
Creating plan from template files in: /tmp/tripleoclient-JzWtMm/tripleo-heat-templates
Started Mistral Workflow tripleo.plan_management.v1.create_deployment_plan. Execution ID: 41db16a0-6768-4029-af7a-a0fad0faa921
Plan created.
Processing templates in the directory /tmp/tripleoclient-JzWtMm/tripleo-heat-templates
Started Mistral Workflow tripleo.plan_management.v1.get_deprecated_parameters. Execution ID: 464bbe1c-23de-45d5-a205-a8b3f7d72d3c
Deploying templates in the directory /tmp/tripleoclient-JzWtMm/tripleo-heat-templates
Started Mistral Workflow tripleo.deployment.v1.deploy_plan. Execution ID: 016f2ca5-97d8-4c58-a808-f609bef976b6
